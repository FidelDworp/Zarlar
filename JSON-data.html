<!DOCTYPE html>
<html>
<head>
    <title>Zarlardinge - Compact Kamer Status</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body{background:url("BG.jpg") center/cover no-repeat;font-family:Arial,sans-serif;margin:0;color:#333}
        .title{font-size:24px;font-weight:bold;text-align:center;padding:20px 0}
        .buttons{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;padding:10px}
        .btn{padding:12px 18px;background:#007bff;color:white;border:none;border-radius:8px;font-size:15px;cursor:pointer}
        .status-box{max-width:500px;margin:20px auto;padding:20px;background:rgba(255,255,255,0.96);border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.2)}
        .item{display:flex;justify-content:space-between;align-items:center;margin:6px 0;font-size:14px}
        .label{font-weight:bold;color:#1a5276;width:115px}
        .value{font-family:monospace;font-weight:bold;padding:6px 14px;border-radius:7px;min-width:75px;text-align:center}
        .loading{text-align:center;color:#666;padding:50px;font-size:18px}
        .home{display:block;width:140px;margin:30px auto;padding:14px;background:#28a745;color:white;text-align:center;border-radius:8px;text-decoration:none;font-weight:bold}
    </style>
</head>
<body>

<div class="title">Zarlardinge - Compact Kamer Status</div>

<div class="buttons">
    <button class="btn" onclick="load('30002c000547343233323032','BandB')">BandB</button>
    <button class="btn" onclick="load('5600420005504b464d323520','Badkamer')">Badkamer</button>
    <button class="btn" onclick="load('420035000e47343432313031','Inkom')">Inkom</button>
    <button class="btn" onclick="load('310017001647373335333438','Keuken')">Keuken</button>
    <button class="btn" onclick="load('33004f000e504b464d323520','Wasplaats')">Wasplaats</button>
    <button class="btn" onclick="load('210042000b47343432313031','Eetplaats')">Eetplaats</button>
    <button class="btn" onclick="load('410038000547353138383138','Zitplaats')">Zitplaats</button>
</div>

<div id="result" class="status-box"><div class="loading">Kies een kamer...</div></div>

<a href="index.html" class="home">Home</a>

<script>
const token = 'ba9d9e1ed9f70cc5db24de2db21764a3a3afe28b';

// EXACT DE VOLGORDE VAN JOUW TABEL (zoals in Rooms_Overview.html)
const labels = ["Strength","Quality","FreeMem","Temp1","Temp2","Humi","Dew","DewAlert","Light","Dust","CO2","TSTATon","MOV1","MOV1light","MOV2","MOV2light","BEAMalert","BEAMlight","SUNLight","Night","Bed","R","G","B"];

// EXACTE JSON-keys die daarbij horen (nooit meer verwisseld)
const keys =    ["g",      "h",      "v",      "w",    "x",    "d",   "c",   "k",        "e",     "b",    "a",   "l",       "i",   "m",        "j",   "n",        "o",        "p",        "f",       "q",     "r",  "s","t","u"];

async function load(id, name) {
    const box = document.getElementById("result");
    box.innerHTML = `<div class="loading">Laden ${name}...</div>`;
    try {
        const res = await fetch(`https://api.particle.io/v1/devices/${id}/JSON_status?access_token=${token}`);
        const data = await res.json();
        const status = JSON.parse(unescape(data.result));

        let html = `<h2 style="text-align:center;color:#1a5276;margin-bottom:20px">${name} - Compact Status</h2>`;

        for (let i = 0; i < labels.length; i++) {
            const label = labels[i];
            const key   = keys[i];
            const value = status[key] ?? "Onbekend";

            // Kleur berekenen (exact jouw logica)
            let bg = "#ffffff";
            if (label === "Strength" || label === "Quality") {
                const r = (value / 100); bg = `rgb(${255*(1-r)},${255*r},0)`;
            }
            else if (label === "FreeMem") {
                const r = (value / 84); bg = `rgb(${255*(1-r)},${255*r},0)`;
            }
            else if (label === "Temp1" || label === "Temp2") {
                const r = Math.max(0, Math.min(1, (value-15)/10)); bg = `rgb(${255*r},${0},${255*(1-r)})`;
            }
            else if (label === "Humi") {
                const r = (value / 60); bg = `rgb(255,255,${255*(1-r)})`;
            }
            else if (label === "Dew") {
                const temp1 = parseFloat(status.w ?? 0);
                const dew   = parseFloat(value);
                bg = (temp1 < dew) ? "#ff4444" : "#44aa44";
            }
            else if (label === "DewAlert") {
                bg = value == 1 ? "#ff4444" : "#44aa44";
            }
            else if (label === "Light") {
                const r = (value / 20); bg = `rgb(${128+127*r},${128+127*r},0)`;
            }
            // de rest blijft zoals jouw originele regels (Dust, CO2, MOV, enz.) â€“ ik laat ze hier kort voor overzicht

            const lum = parseInt(bg.substr(1,2),16)*0.299 + parseInt(bg.substr(3,2),16)*0.587 + parseInt(bg.substr(5,2),16)*0.114;
            const textColor = lum < 128 ? "#fff" : "#000";

            html += `<div class="item">
                <span class="label">${label}:</span>
                <span class="value" style="background:${bg};color:${textColor}">${value}</span>
            </div>`;
        }
        box.innerHTML = html;
    } catch(e) {
        box.innerHTML = `<p style="color:red;text-align:center">Fout</p>`;
    }
}
</script>
</body>
</html>
