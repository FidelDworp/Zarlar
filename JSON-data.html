<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Zarlardinge - Compact Kamer Status</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body{margin:0;font-family:Arial;background:url('BG.jpg') center/cover no-repeat}
        .title{font-size:24px;font-weight:bold;text-align:center;padding:20px;color:#333}
        .buttons{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;padding:10px}
        .btn{padding:12px 20px;background:#007bff;color:#fff;border:none;border-radius:8px;font-size:15px;cursor:pointer}
        .box{max-width:480px;margin:20px auto;padding:20px;background:rgba(255,255,255,0.95);border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.2)}
        .row{display:flex;justify-content:space-between;margin:4px 0;font-size:13px}
        .lbl{font-weight:bold;color:#1a5276;width:110px}
        .val{font-family:monospace;font-weight:bold;padding:4px 10px;border-radius:5px;min-width:70px;text-align:center}
        .home{display:block;width:120px;margin:30px auto;padding:12px;background:#28a745;color:#fff;text-align:center;border-radius:8px;text-decoration:none}
    </style>
</head>
<body>
<div class="title">Zarlardinge - Compact Kamer Status</div>
<div class="buttons">
    <button class="btn" onclick="go('30002c000547343233323032','BandB')">BandB</button>
    <button class="btn" onclick="go('5600420005504b464d323520','Badkamer')">Badkamer</button>
    <button class="btn" onclick="go('420035000e47343432313031','Inkom')">Inkom</button>
    <button class="btn" onclick="go('310017001647373335333438','Keuken')">Keuken</button>
    <button class="btn" onclick="go('33004f000e504b464d323520','Wasplaats')">Wasplaats</button>
    <button class="btn" onclick="go('210042000b47343432313031','Eetplaats')">Eetplaats</button>
    <button class="btn" onclick="go('410038000547353138383138','Zitplaats')">Zitplaats</button>
</div>
<div id="box" class="box"><div style="text-align:center;padding:40px;color:#666">Kies een kamer</div></div>
<a href="index.html" class="home">Home</a>

<script>
const token='ba9d9e1ed9f70cc5db24de2db21764a3a3afe28b';

// VOLGORDE EXACT ZOALS JOUW TABEL
const order = ["Strength","Quality","FreeMem","Temp1","Temp2","Humi","Dew","DewAlert","Light","Dust","CO2","TSTATon","MOV1","MOV1light","MOV2","MOV2light","BEAMalert","BEAMlight","SUNLight","Night","Bed","R","G","B"];
const keyOf = {Strength:"g",Quality:"h",FreeMem:"v",Temp1:"w",Temp2:"x",Humi:"d",Dew:"c",DewAlert:"k",Light:"e",Dust:"b",CO2:"a",TSTATon:"l",MOV1:"i",MOV1light:"m",MOV2:"j",MOV2light:"n",BEAMalert:"o",BEAMlight:"p",SUNLight:"f",Night:"q",Bed:"r",R:"s",G:"t",B:"u"};

const rules = { // exact jouw columnRules
    Strength:{min:0,max:100,r:"red",g:"green"},
    Quality:{min:0,max:100,r:"red",g:"green"},
    FreeMem:{min:0,max:84,r:"red",g:"green"},
    Temp1:{min:15,max:25,r:"blue",g:"red"},
    Temp2:{min:15,max:25,r:"blue",g:"red"},
    Humi:{min:0,max:60,r:"white",g:"blue"},
    Dew:{special:true},
    DewAlert:{min:0,max:1,r:"green",g:"red"},
    Light:{min:0,max:20,r:"gray",g:"yellow"},
    Dust:{min:0,max:100,r:"white",g:"black"},
    CO2:{min:0,max:800,r:"green",g:"red"},
    TSTATon:{min:0,max:1,r:"white",g:"red"},
    MOV1:{min:0,max:100,r:"white",g:"black"},
    MOV1light:{min:0,max:1,r:"white",g:"yellow"},
    MOV2:{min:0,max:100,r:"white",g:"black"},
    MOV2light:{min:0,max:1,r:"white",g:"yellow"},
    BEAMalert:{min:0,max:1,r:"white",g:"orange"},
    BEAMlight:{min:0,max:1,r:"white",g:"yellow"},
    SUNLight:{min:0,max:5000,r:"white",g:"yellow"},
    Night:{min:0,max:1,r:"white",g:"black"},
    Bed:{min:0,max:1,r:"white",g:"purple"},
    R:{min:0,max:255,r:"white",g:"red"},
    G:{min:0,max:255,r:"white",g:"green"},
    B:{min:0,max:255,r:"white",g:"blue"}
};

const cmap={red:[255,0,0],green:[0,255,0],blue:[0,0,255],white:[255,255,255],black:[0,0,0],yellow:[255,255,0],gray:[128,128,128],orange:[255,165,0],purple:[128,0,128]};

function color(val, rule, temp1){
    if(val==="Onbekend")return"#fff";
    if(rule.special){
        return parseFloat(temp1)<parseFloat(val)?"#ff4444":"#44aa44";
    }
    const ratio=Math.max(0,Math.min(1,(parseFloat(val)-rule.min)/(rule.max-rule.min)));
    const a=cmap[rule.r], b=cmap[rule.g];
    const rgb=`rgb(${Math.round(a[0]+(b[0]-a[0])*ratio)},${Math.round(a[1]+(b[1]-a[1])*ratio)},${Math.round(a[2]+(b[2]-a[2])*ratio)})`;
    const lum=0.299*parseInt(rgb.match(/\d+/g)[0])+0.587*parseInt(rgb.match(/\d+/g)[1])+0.114*parseInt(rgb.match(/\d+/g)[2]);
    return {bg:rgb, txt:lum<128?"#fff":"#000"};
}

async function go(id,name){
    document.getElementById("box").innerHTML=`<div style="text-align:center;padding:50px">Laden ${name}...</div>`;
    const r=await fetch(`https://api.particle.io/v1/devices/${id}/JSON_status?access_token=${token}`);
    const d=await r.json();
    const s=JSON.parse(unescape(d.result));
    const t1=s.w;

    let html=`<h2 style="text-align:center;color:#1a5276;margin-bottom:15px">${name} - Compact Status</h2>`;
    order.forEach(l=>{
        const v=s[keyOf[l]]??'Onbekend';
        const c=color(v,rules[l],t1);
        html+=`<div class="row"><span class="lbl">${l}:</span><span class="val" style="background:${c.bg};color:${c.txt}">${v}</span></div>`;
    });
    document.getElementById("box").innerHTML=html;
}
</script>
</body>
</html>
